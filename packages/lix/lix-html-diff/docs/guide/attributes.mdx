import { Showcase } from "../components/showcase";

# Attributes

HTML diff uses data attributes to control how elements are diffed and displayed.

## data-diff-key

**Required for all elements you want to track changes for.**

The `data-diff-key` attribute provides a unique identifier that allows the diff algorithm to match elements between the "before" and "after" states.

```html
<p data-diff-key="kx8m">Hello World</p>
```

### Example: Adding an element

```html
<!-- Before -->
<div>
  <p data-diff-key='ixn4'>First paragraph</p>
</div>

<!-- After -->
<div>
  <p data-diff-key='ixn4'>First paragraph</p>
  <p data-diff-key='zm7q'>Second paragraph</p>
</div>
```

<Showcase 
  before="<div><p data-diff-key='ixn4'>First paragraph</p></div>" 
  after="<div><p data-diff-key='ixn4'>First paragraph</p><p data-diff-key='zm7q'>Second paragraph</p></div>" 
  css=".diff-created { color: green; } .diff-updated { color: orange; } .diff-deleted { color: red; }"
/>

### Example: Removing an element

```html
<!-- Before -->
<div>
  <p data-diff-key='bw5c'>Keep this</p>
  <p data-diff-key='ft9x'>Remove this</p>
</div>

<!-- After -->
<div>
  <p data-diff-key='bw5c'>Keep this</p>
</div>
```

<Showcase 
  before="<div><p data-diff-key='bw5c'>Keep this</p><p data-diff-key='ft9x'>Remove this</p></div>" 
  after="<div><p data-diff-key='bw5c'>Keep this</p></div>" 
  css=".diff-created { color: green; } .diff-updated { color: orange; } .diff-deleted { color: red; }"
/>

## data-diff-mode

**Optional attribute to control diffing behavior.**

By default, when text content changes, elements with `data-diff-key` are marked as `diff-updated`. The `data-diff-mode` attribute allows you to specify different diffing behaviors for more control.

### element

Use `data-diff-mode="element"` to explicitly mark the element for atomic element diffing. When content changes, the old element is shown as `diff-deleted` and the new element is shown as `diff-created`.

```html
<!-- Before -->
<div class="card" data-diff-key="my-card" data-diff-mode="element">
  <h3>Old Title</h3>
  <p>Old content here</p>
</div>

<!-- After -->
<div class="card" data-diff-key="my-card" data-diff-mode="element">
  <h3>New Title</h3>
  <p>New content here</p>
</div>
```

<Showcase 
  before="<div class='card' data-diff-key='my-card' data-diff-mode='element'><h3>Old Title</h3><p>Old content</p></div>" 
  after="<div class='card' data-diff-key='my-card' data-diff-mode='element'><h3>New Title</h3><p>New content</p></div>" 
  css=".diff-created { color: green; } .diff-updated { color: orange; } .diff-deleted { color: red; } .card { border: 1px solid #ccc; padding: 10px; margin: 5px 0; }"
/>

#### When to use element mode

✅ **Use for complex HTML structures:**
- Components with nested elements and specific styling
- Elements where word-level diffing would break the UI
- Cards, panels, or widgets with multiple child elements
- Interactive components (buttons, forms, etc.)

❌ **Avoid for simple text content:**
- Plain paragraphs or headings
- Simple text spans
- Content where word-level diffing would be more useful

### words

Use `data-diff-mode="words"` to enable granular word-level diffing within the element instead of atomic block diffing.

#### Without data-diff-mode (atomic block diffing)

```html
<!-- Before -->
<p data-diff-key='qr8n'>Hello there</p>

<!-- After -->
<p data-diff-key='qr8n'>Hello world</p>
```

<Showcase 
  before="<p data-diff-key='qr8n'>Hello there</p>" 
  after="<p data-diff-key='qr8n'>Hello world</p>" 
  css=".diff-created { color: green; } .diff-updated { color: orange; } .diff-deleted { color: red; }"
/>

#### With data-diff-mode="words" (granular word diffing)

```html
<!-- Before -->
<p data-diff-key='kv3m' data-diff-mode="words">Hello there</p>

<!-- After -->
<p data-diff-key='kv3m' data-diff-mode="words">Hello world</p>
```

<Showcase 
  before="<p data-diff-key='kv3m' data-diff-mode='words'>Hello there</p>" 
  after="<p data-diff-key='kv3m' data-diff-mode='words'>Hello world</p>" 
  css=".diff-created { color: green; } .diff-updated { color: orange; } .diff-deleted { color: red; }"
/>

#### When to use data-diff-mode="words"

✅ **Use for simple text content:**
- Paragraphs with plain text
- Headings
- Simple spans

❌ **Avoid for complex components:**
- Components with nested HTML structure
- Elements with specific styling that would break with inserted spans
- Interactive components (buttons, forms, etc.)

#### Example: Complex component (avoid data-diff-mode="words")

```html
<!-- Before -->
<div class='card' data-diff-key='jx9w'>
  <h3>Old Title</h3>
  <p>Content</p>
</div>

<!-- After -->
<div class='card' data-diff-key='jx9w'>
  <h3>New Title</h3>
  <p>Content</p>
</div>
```

<Showcase 
  before="<div class='card' data-diff-key='jx9w'><h3>Old Title</h3><p>Content</p></div>" 
  after="<div class='card' data-diff-key='jx9w'><h3>New Title</h3><p>Content</p></div>" 
  css=".diff-created { color: green; } .diff-updated { color: orange; } .diff-deleted { color: red; } .card { border: 1px solid #ccc; padding: 10px; }"
/>

The atomic block approach preserves the component structure while clearly showing what changed.